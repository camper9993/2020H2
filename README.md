# Лабораторная 3 
## Система торгов. Сервер.
## Инструкция по использованию
Проект написаны на Kotlin JVM и требуют JDK 1.8 для сборки и JRE 1.8 для работы. Сборка осуществляется через систему Gradle. 
Дополнительно скачивать Gradle не нужно. В репозитории хранятся скрипты Gradle Wrapper, которые могут скачать нужную версию Gradle в случае необходимости. 
Для запуска клиента необходимо ввести: Linux - ./gradlew run, Windows - gradlew run.
## Описание протокола

Все пакеты, состоят из двух частей:

##### Первый байт - число. Если этот пакет от клиента серверу - это команда. Если это пакет от сервера клиенту - результат выполнения запроса.

Возможные значения:

От клиента серверу (команды):

 - 0 - Авторизация клиента на сервере.
 - 1 - Сделать ставку (участник).
 - 2 - Запрос на получение списка лотов (участник).
 - 3 - Добавление нового лота (администратор).
 - 4 - Остановить торги и показать результаты (администратор).
 - 5 - Выйти из аккаунта
 
От сервера клиенту (результат выполнения запроса клиента):

 - 0 - Успешный обработка запроса клиента.
 - 1 - Ошибка. 
 
##### Вторая часть пакета - строка, в которой содержится информация в формате Json.

После отправки любой команды из списка выше на сервер, сервер отвечает пакетом, который содержит команду с результатом
выполнения запроса клиента и сообщение в формате json с информацией о выполненнии запроса:

`
{
"message": "Success!"
}
`

* Авторизация - для авторизации нужно послать на сервер пакет с командой 0 и задать два параметра -name <Имя клиента> и -type <Участник или администратор торгов (participant или steward соответственно)>

`
{
"name": "example",
"type": "steward"
}
`

В случае успеха вернется приветственное сообщение.

* Добавление нового лота (только для администратора)

Для добавления нового лота передать команду (3) и задать два параметра -name и -price. 

`
{
"name": "Ball",
"price": "100",
"owner": "null" //при добавлении лота администратором владельца нет
}
`

* Получение всех лотов. (только для участника)

Для получения всех лотов нужно передать только команду (2). Письма приходят в формате json:

`
[
{
"name": "Ball",
"price": "150",
"owner": "Jack"
}, {
"name": "Bat",
"price": "100",
"owner": "null" //никто не купил
}
]
`

* Сделать ставку (только для участника)

Для создания ставки нужно отправить команду (1), указать имя лота, повысить цену и указать свое имя.
`
{
"name": "Ball",
"price": "150",
"owner": "Jack"
}
`

*Остановить торги (только для администратора)

Для получения всех лотов нужно передать только команду (4). Результаты приходят в формате json:

`
[
{
"name": "Ball",
"price": "150",
"owner": "Jack"
}, {
"name": "Bat",
"price": "100",
"owner": "null" //никто не купил
}
]
`

* Выход с сервера

Для выхода с сервера нужно передать только команду (5).


## Реализация сервера
#### Основные возможности:

1) Прослушивание определенного порта
2) Обработка запросов на подключение по этому порту от клиентов
системы торгов (как распорядитель или участник торгов)
3) Поддержка одновременной работы нескольких клиентов системы
торгов через механизм нитей
4) От участников торгов: прием запросов на передачу списка лотов
5) От участников торгов: прием запросов на повышение стоимости лота
6) От распорядителя: прием запроса на добавление нового лота с пер-
воначальной стоимостью
7) От распорядителя: прием запроса об окончании торгов
8) Осуществление добавления лота, учет повышения стоимости лота
участниками, завершение торгов и рассылка результатов торгов всем участникам
9) Обработка запроса на отключение клиента 10) Принудительное отключение клиента

По умолчанию сервер запускаeтся на адресе 127.0.0.1 и на порту - 9999, это можно изменить с помощью аргументов командной строки `<host> <port>` или `<host>`.